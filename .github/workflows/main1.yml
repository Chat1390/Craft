name: Get Playit Claim Code
on: workflow_dispatch

jobs:
  build:
    runs-on: windows-latest
    steps:
    - name: Download Playit
      run: |
        curl -L -o playit.exe https://github.com/playitcloud/playit-agent/releases/latest/download/playit-windows-x86_64.exe

    - name: Run and Show Code
      shell: pwsh
      run: |
        # اجرای برنامه در پس‌زمینه و صبر کردن برای تولید کد
        $process = Start-Process ./playit.exe -PassThru
        Write-Host "صبر کنید تا کد تولید شود..."
        Start-Sleep -Seconds 20
        
        # تلاش برای نمایش خروجی و نگه داشتن سرور به مدت ۳۰ دقیقه
        Write-Host "حالا به لاگ‌های پایین نگاه کن و لینک Claim را پیدا کن"
        Write-Host "بعد از کلیک روی لینک، این صفحه را نبند تا سرور فعال بماند"
        
        # ایجاد یک حلقه برای زنده نگه داشتن محیط جهت تایید شما
        Start-Sleep -Seconds 1800
